<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Kaiqian Zhang" />


<title>SuSiE for Nonparametric Regression Summary</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">susie-np</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jdblischak/workflowr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">SuSiE for Nonparametric Regression Summary</h1>
<h4 class="author">Kaiqian Zhang</h4>
<h4 class="date">4/22/2019</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#report"> Report <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2019-04-23
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>susie-np/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.2.0). The <em>Report</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="report" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20190114code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20190114)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20190114code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20190114)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomKaiqianZhangsusienptree66b6d1aaaa1d885b3198127afc944cf0ad6d7507targetblank66b6d1aa"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/KaiqianZhang/susie-np/tree/66b6d1aaaa1d885b3198127afc944cf0ad6d7507" target="_blank">66b6d1a</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomKaiqianZhangsusienptree66b6d1aaaa1d885b3198127afc944cf0ad6d7507targetblank66b6d1aa" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/.DS_Store

Untracked files:
    Untracked:  analysis/resid.RDS
    Untracked:  analysis/resid.RDS.zip
    Untracked:  analysis/wavelet-susie-20190131.Rmd
    Untracked:  analysis/wavelet-susie-20190224.Rmd
    Untracked:  analysis/wavelet-susie-20190228-3.Rmd
    Untracked:  data/dsc_em_output.RDS
    Untracked:  data/susie-np-dscout.RDS
    Untracked:  data/susie-np-dscout30.RDS
    Untracked:  data/susie-tf-dscout.RDS
    Untracked:  data/susie-tf-dscout2.RDS
    Untracked:  docs/figure/wavelet-susie-20190213.Rmd/
    Untracked:  docs/figure/wavelet-susie-20190224.Rmd/
    Untracked:  figure/

Unstaged changes:
    Modified:   analysis/UDWT.Rmd
    Deleted:    analysis/UDWT2.Rmd
    Modified:   analysis/dsc-susie-smashr-20190403.Rmd
    Modified:   analysis/susie-a-20190305.Rmd
    Modified:   analysis/susie-a-20190307.Rmd
    Modified:   analysis/susie-tf-MAD-20190416.Rmd
    Modified:   analysis/v_methods_comparison_dsc_20190213.Rmd
    Modified:   analysis/wavelet-susie-20190121.Rmd
    Modified:   analysis/wavelet-susie-20190130.Rmd
    Modified:   analysis/wavelet-susie-20190215.Rmd
    Modified:   analysis/wavelet-susie-20190222-2.Rmd
    Modified:   analysis/wavelet-susie-20190228.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the R Markdown and HTML files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view them.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KaiqianZhang/susie-np/blob/66b6d1aaaa1d885b3198127afc944cf0ad6d7507/analysis/susie-np-summary-20190422.Rmd" target="_blank">66b6d1a</a>
</td>
<td>
kaiqian
</td>
<td>
2019-04-23
</td>
<td>
finish section 4
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KaiqianZhang/susie-np/14ccb3bf8abc4857ebe9102ccfe5e0ae09133d73/docs/susie-np-summary-20190422.html" target="_blank">14ccb3b</a>
</td>
<td>
kaiqian
</td>
<td>
2019-04-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KaiqianZhang/susie-np/blob/bad5cf7a7b3d6a5799a5302123b69387fea45727/analysis/susie-np-summary-20190422.Rmd" target="_blank">bad5cf7</a>
</td>
<td>
kaiqian
</td>
<td>
2019-04-22
</td>
<td>
almost finish the first three parts
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KaiqianZhang/susie-np/4c2b38f24624199d79ef9f076259bf5d1ca089d0/docs/susie-np-summary-20190422.html" target="_blank">4c2b38f</a>
</td>
<td>
kaiqian
</td>
<td>
2019-04-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KaiqianZhang/susie-np/blob/8be86c147a8e8f7bc4f45caaf7d4257c82a39aea/analysis/susie-np-summary-20190422.Rmd" target="_blank">8be86c1</a>
</td>
<td>
kaiqian
</td>
<td>
2019-04-22
</td>
<td>
start my summary for susie-np
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="introduction" class="section level2">
<h2>1 Introduction</h2>
<p>We consider a nonparametric regression problem for estimating a regression function <span class="math inline">\(f\)</span>, from observations <span class="math inline">\(\{(x_i, y_i): i=1,2,\dots, n\}\)</span>, with <span class="math inline">\(x_i\)</span> and <span class="math inline">\(y_i \in \mathbb{R}\)</span>, and <span class="math inline">\(y_i = f(x_i) + \epsilon_i\)</span> for <span class="math inline">\(i = 1,2,\dots,n\)</span>, where <span class="math inline">\(\epsilon_i\)</span> are independent, mean <span class="math inline">\(0\)</span>, and Gaussian distributed random variables. A popular approach for estimating <span class="math inline">\(f\)</span> is to use linear combinations of a pre-specified set of basis functions, e.g., polynomials, splines, and wavelets. Here, we are interested in two types of basis functions: trend filtering (<a href="https://web.stanford.edu/~boyd/papers/pdf/l1_trend_filter.pdf">Kim et al., 2009</a>) and wavelets (<a href="https://jqichina.files.wordpress.com/2012/02/ten-lectures-of-waveletsefbc88e5b08fe6b3a2e58d81e8aeb2efbc891.pdf">Daubechies, 1992</a>). The weights, or coefficients, in such a linear combination are usually determined using some form of penalized regression. For this work, we consider using a sparse regression framework <a href="https://stephenslab.github.io/susieR/">SuSiE</a>, which is a fast Bayesian sparse regression method newly developed by <a href="https://github.com/stephenslab">Stephens lab</a>.</p>
<p>In this summary, we present some efforts have been done in applying SuSiE in nonparametric regression problems, specifically using basis functions of trend filtering and wavelets. In Section 2 we present trend filtering-based SuSiE and its application in solving change points problem. In Section 3 we introduce Haar wavelet-based SuSiE as well as decimated and undecimated versions. In Section 4 we further establish a more general Haar wavelet-based SuSiE method, which allows irregularly spaced data and the number to be not a power of <span class="math inline">\(2\)</span>. In Section 5 we consider another family of wavelets Symlet and present results from simulation studies related. In Section 6 we discuss one estimating residual variance problem of SuSiE found throughout the work and how we can address this problem by using MAD method.</p>
</div>
<div id="trend-filtering-based-susie" class="section level2">
<h2>2 Trend filtering-based SuSiE</h2>
<p>Nonparametric regression with trend filtering basis is defined mathematically as follows. For a given integer <span class="math inline">\(k \geq 0\)</span>, the kth order trend filtering is defined by a penalized least squares optimization problem, <span class="math display">\[
\begin{align}
\hat{\boldsymbol{b}} = \underset{\boldsymbol{b}}{\mathrm{argmin}} \frac{1}{2}|| \boldsymbol{y}- \boldsymbol{b}||_2^2 + \frac{n^k}{k!}\lambda||D_{k+1} \boldsymbol{b}||_1,
\end{align}
\]</span> where <span class="math inline">\(\boldsymbol{y} = [y_1, y_2, \dots y_n]^T\)</span> is an n vector of observations, <span class="math inline">\(\lambda\)</span> is a tuning parameter, and <span class="math inline">\(D_{k+1}\)</span> is the discrete difference operator of order <span class="math inline">\(k\)</span>. When order <span class="math inline">\(k=0\)</span>, <span class="math inline">\(D\)</span> is defined <span class="math display">\[
\begin{align}\label{D1}
D_{1} = \begin{bmatrix} 
    -1 &amp; 1 &amp; 0 &amp; \dots &amp; 0 &amp; 0\\
    0 &amp; -1 &amp; 1 &amp; \dots &amp; 0 &amp; 0\\
    \vdots &amp; \ddots &amp; \\
    0 &amp; 0 &amp; 0 &amp; \dots &amp; -1 &amp; 1\\
    \end{bmatrix}
    \in \mathbb{R}^{(n-1)\times n}.
\end{align}
\]</span> In this case, components of trend filtering estimate form a piecewise constant structure, with break points corresponding to the nonzero entries of <span class="math inline">\(D_{1}\hat{\boldsymbol{b}} = (\hat{b}_2 - \hat{b}_1, \dots, \hat{b}_n - \hat{b}_{n-1})\)</span> (<a href="http://www.stat.cmu.edu/~ryantibs/papers/trendfilter.pdf">Tibshirani, 2014</a>). And when <span class="math inline">\(k\geq 1\)</span>, the operator <span class="math inline">\(D_{k+1}\)</span> is defined recursively,</p>
<p><span class="math display">\[
\begin{align}
D_{k+1} = D_{1} \cdot D_{k} \in \mathbb{R}^{(n-k-1)\times n},
\end{align}
\]</span> where the dot product is matrix multiplication. Notice that <span class="math inline">\(D_1\)</span> in the equation above is the <span class="math inline">\((n-k-1)\times (n-k)\)</span> version of <span class="math inline">\(D_1\)</span> matrix as described before.</p>
<p>Now we want to transform the trend filtering problem into a sparse regression problem. Let <span class="math inline">\(\boldsymbol{\beta}=D_{k+1}\boldsymbol{b}\)</span>. Then if <span class="math inline">\(D_{k+1}\)</span> were invertibe, we could write <span class="math inline">\(\boldsymbol{b} = (D_{k+1})^{-1}\boldsymbol{\beta}\)</span> and the above problem would become</p>
<p><span class="math display">\[
\begin{align}
\hat{\boldsymbol{\beta}} = \underset{\boldsymbol{\beta}}{\mathrm{argmin}} \frac{1}{2}||\boldsymbol{y}- (D_{k+1})^{-1}\boldsymbol{\beta}||_2^2 + \frac{n^k}{k!}\lambda||\boldsymbol{\beta}||_1.
\end{align}
\]</span> We can consider this a sparse regression with <span class="math inline">\(\ell_1\)</span> regularization problem, where the design matrix is <span class="math inline">\((D_{k+1})^{-1}\)</span>. We also know that given a deisgn matrix <span class="math inline">\(X\)</span> and a vector of observations <span class="math inline">\(\boldsymbol{y}\)</span>, SuSiE performs sparse regression to estimate coefficients <span class="math inline">\(\boldsymbol{\beta}\)</span>. Therefore, trend filtering-based SuSiE is just substituting the design matrix <span class="math inline">\(X\)</span> with <span class="math inline">\((D_{k+1})^{-1}\)</span>. Implementation details and tricks associated can be seen from <code>SuSiE Derivation</code> (Overleaf) and <a href="https://github.com/stephenslab/susieR/blob/master/R/trend_filtering_multiplication.R"><code>susieR</code> package</a>. And notice that we use Haar wavelets in the <code>susie_trendfilter</code> implementation.</p>
<p>We tried <code>susie_trendfilter</code> on some <a href="https://stephenslab.github.io/susieR/articles/trend_filtering.html">minimal examples</a> and discovered that trend filtering-based SuSiE performs well in estimating piecewise constant functions, i.e., change points detection problem, except in one scenario when two change points are in a quick succession. We later used <a href="https://kaiqianzhang.github.io/susie-np/susie-tf-MAD-20190411.html">MAD method</a>, which will be discussed in Section 6, to help soothe the problem. More details of simulation studies associated are <a href="https://kaiqianzhang.github.io/susie-np/susie-tf-MAD-20190416.html">here</a>. [FIXME: maybe new dsc analysis]</p>
</div>
<div id="decimated-and-undecimated-wavelet-transform-dwt-and-udwt" class="section level2">
<h2>3 Decimated and undecimated wavelet transform (DWT and UDWT)</h2>
<div id="introduction-to-wavelets-and-discrete-wavelet-transform-dwt" class="section level3">
<h3>3.1 Introduction to wavelets and discrete wavelet transform (DWT)</h3>
<p>Now we consider wavelets and start with some background of wavelets. Wavelets are a system of orthonormal basis functions for <span class="math inline">\(L^2([0,1])\)</span>. The bases are generated by translations and dilations of special functions <span class="math inline">\(\phi(.)\)</span> and <span class="math inline">\(\psi(.)\)</span> called the father and mother wavelet. So for any <span class="math inline">\(j_0\geq 0\)</span>, a funcrion <span class="math inline">\(f\in L^2([0,1])\)</span> can be written as</p>
<p><span class="math display">\[
f(x) = \sum_{k=0}^{2^{j_0}-1}\alpha_{j_0k}\phi_{j_0k}(x) + \sum_{j=j_0}^{\infty}\sum_{k=0}^{2^j-1}\beta_{jk}\psi_{jk}(x)
\]</span> where <span class="math display">\[
\phi_{jk}(x) = 2^{j/2}\phi(2^jx-k), \text{ } \psi_{jk}(x) = 2^{j/2}\psi(2^jx-k).
\]</span> The coefficients <span class="math inline">\(\alpha_{j_0k}\)</span> and <span class="math inline">\(\beta_{jk}\)</span> are called the father and mother wavelets, respectively. The index <span class="math inline">\(j\)</span> is called the resolution level and <span class="math inline">\(j_0\)</span> is the minimum resolution level. Different choices of <span class="math inline">\(\phi\)</span> and <span class="math inline">\(\psi\)</span> generate various wavelet families, e.g., Haar wavelets and Symlet wavelets.</p>
<p>We often truncate the above expression for some <span class="math inline">\(J\)</span> such that <span class="math display">\[
f(x) = \sum_{k=0}^{2^{j_0}-1}\alpha_{j_0k}\phi_{j_0k}(x) + \sum_{j=j_0}^{J}\sum_{k=0}^{2^j-1}\beta_{jk}\psi_{jk}(x).
\]</span> We would consider truncated version wavelets hereafter. For any vector <span class="math inline">\(\boldsymbol{f} = [f(1/n), f(2/n), \dots, f(n/n)]^T\)</span> with <span class="math inline">\(n = 2^J\)</span> for some <span class="math inline">\(J\)</span>, we can write a linear combination such that <span class="math display">\[
\boldsymbol{f} = W^T \boldsymbol{d},
\]</span> where <span class="math inline">\(\boldsymbol{d} = (\alpha_{j_00}, \dots, \alpha_{2^{j_0}-1}, \beta_{j_00}, \beta_{j_01}, \dots, \beta_{J2^{J}-1})^T\)</span> is the vector of wavelet coefficients, and the rows of <span class="math inline">\(W\)</span> are basis functions evaluated at <span class="math inline">\(x_i = i/n\)</span>. By orthogonality, <span class="math display">\[
\boldsymbol{d} = W\boldsymbol{f}.
\]</span> This transformation from <span class="math inline">\(\boldsymbol{f}\)</span> to its wavelet coefficients via multiplication by <span class="math inline">\(W\)</span> is known as the discrete/decimated wavelet transform (DWT). The DWT can be computed in <span class="math inline">\(O(n)\)</span> operations via Mallat’s pyramid algorithm (<a href="https://www.di.ens.fr/~mallat/papiers/MallatTheory89.pdf">Mallat, 1989</a>). Implementation for this has not been realized in SuSiE yet.</p>
</div>
<div id="wavelet-based-susie" class="section level3">
<h3>3.2 Wavelet-based SuSiE</h3>
<p>Given a short introduction of wavelets, we now present wavelet-based SuSiE, which has a similar idea as trend filtering-based SuSiE in Section 2. A nonparametric regression problem in the wavelets context is <span class="math display">\[
\begin{align}
\hat{\boldsymbol{b}} = \underset{\boldsymbol{b}}{\mathrm{argmin}} \frac{1}{2}|| \boldsymbol{y}- \boldsymbol{b}||_2^2 + \lambda||W \boldsymbol{b}||_1,
\end{align}
\]</span> where <span class="math inline">\(\boldsymbol{y} = [y_1, y_2, \dots y_n]^T\)</span> is an n vector of observations, <span class="math inline">\(\lambda\)</span> is a tuning parameter, and <span class="math inline">\(W\)</span> is the DWT matrix described before. Let <span class="math inline">\(\boldsymbol{\beta} = W\boldsymbol{b}\)</span>. Then <span class="math inline">\(\boldsymbol{b} = W^T\boldsymbol{\beta}\)</span> since <span class="math inline">\(W\)</span> is orthogonal. The above problem similarly becomes <span class="math display">\[
\begin{align}
\hat{\boldsymbol{\beta}} = \underset{\boldsymbol{\beta}}{\mathrm{argmin}} \frac{1}{2}||\boldsymbol{y}- W^T\boldsymbol{\beta}||_2^2 +\lambda||\boldsymbol{\beta}||_1.
\end{align}
\]</span> Therefore, wavelet-based SuSiE uses design matrix <span class="math inline">\(W^T\)</span> and observations <span class="math inline">\(\boldsymbol{y}\)</span> to estimate <span class="math inline">\(\boldsymbol{\beta}\)</span>.</p>
</div>
<div id="undecimated-wavelet-transform-udwt" class="section level3">
<h3>3.3 Undecimated wavelet transform (UDWT)</h3>
<p>We previously introduce the concept of DWT and often use DWT for removing noise from signals and images, which we call denoising. Such denoising usually involves three steps:</p>
<ul>
<li><p>Use DWT to transform noisy data into an orthogonal domain, i.e., wavelet coefficients.</p></li>
<li><p>Apply soft or hard thresholding to the wavelet coefficients, thereby suppressing those coefficients smaller than a certain amplitude.</p></li>
<li><p>Transform back to the original domain.</p></li>
</ul>
<p>Such denoising, however, sometimes exhibits visual artifacts, e.g., <a href="https://en.wikipedia.org/wiki/Gibbs_phenomenon">Gibbs phenomena</a> in the neighborhood of discontinuity. Coifman and Donoho (<a href="https://web.stanford.edu/dept/statistics/cgi-bin/donoho/wp-content/uploads/2018/08/TIDeNoise.pdf">1995</a>) attributed this peculiar manner to the lack of translation invariance of the wavelet basis. One method for solving this problem is to use undecimated wavelet transform (UDWT) in the denoising. The intuition is for a range of shifts, one shifts the data, denoises the shifted data, and then unshifts the denoised data. Doing this for each of a range of shifts, and averaging the several results so obtained, produces a reconstruction subject to far weaker Gibbs phenomena than thresholding based denoising using traditional DWT. Cycle-Spinning over the range of all circulant shifts can be accomplished in order n log2(n) time; it is equivalent to denoising using the undecimated or stationary wavelet transform.</p>
<p>One decent denoising method using UDWT is <a href="https://github.com/stephenslab/smashr">smashr</a> (<a href="https://arxiv.org/abs/1605.07787">Xing and Stephens, 2016</a>), which will be used to compare with wavelet-based SuSiE later in the simulation studies. We tried minimal examples on wavelet-based SuSiE with UDWT basis but <a href="https://kaiqianzhang.github.io/susie-np/wavelet-susie-20190117.html">results</a> are not well as expected.</p>
</div>
</div>
<div id="wavelet-based-susie-for-irregularly-spaced-data" class="section level2">
<h2>4 Wavelet-based SuSiE for irregularly spaced data</h2>
<p>Given that we have n observations <span class="math inline">\(\{(x_i, y_i): i=1,2,\dots, n\}\)</span>, <span class="math inline">\(W\)</span> in the Section 3.2 is an n by n matrix. One pain for using wavelets here is we require:</p>
<ul>
<li><p><span class="math inline">\(n\)</span> is a power of 2, i.e., <span class="math inline">\(n=2^J\)</span> for some <span class="math inline">\(J\)</span>;</p></li>
<li><p><span class="math inline">\(x_i\)</span>’s have to be equally spaced, i.e., <span class="math inline">\(x_i = \frac{i}{n}\)</span> for <span class="math inline">\(i=1,2,\dots,n\)</span>.</p></li>
</ul>
<p>Haris et al. (<a href="https://papers.nips.cc/paper/8112-wavelet-regression-and-additive-models-for-irregularly-spaced-data.pdf">2018</a>) proposed an n by K interpolation matrix <span class="math inline">\(R\)</span> to help solve this issue. The <span class="math inline">\((i,j)\)</span>th entry of <span class="math inline">\(R\)</span> is</p>
<p><span class="math display">\[
R_{ij}:=
 \begin{cases} 
      1 &amp; j=1, x_i \leq 1/K \\
      (j+1)-Kx_i &amp; j = \lfloor K x_i \rfloor, x_i \in (1/K,1] \\
      Kx_i - (j-1) &amp; j = \lceil Kx_i \rceil, x_i \in (1/K,1] \\
      0 &amp; \text{otherwise},
   \end{cases}
\]</span> where <span class="math inline">\(K = 2^{\lceil log_2 n \rceil}\)</span>, i.e., K is the smallest power of <span class="math inline">\(2\)</span> number that is greater than n.</p>
<p>Then the sparse regression we want to solve becomes</p>
<p><span class="math display">\[
\hat{\beta} = \underset{\beta}{\mathrm{argmin}} \frac{1}{2}||y- RW^T\beta||_2^2 + \lambda||\beta||_1,
\]</span> where <span class="math inline">\(\boldsymbol{y} = [y_1, y_2, \dots y_n]^T\)</span> is an n vector of observations, <span class="math inline">\(\lambda\)</span> is a tuning parameter, <span class="math inline">\(R\)</span> is an n by K matrix, <span class="math inline">\(W\)</span> is a K by K matrix from Haar DWT with K bases, and <span class="math inline">\(\boldsymbol{\beta}\)</span> is a K by 1 column vector.</p>
<p><a href="https://kaiqianzhang.github.io/susie-np/wavelet-susie-20190228.html">Initial analysis</a> for this interpolated wavelet-based SuSiE renders both good and bad fits, which motivate us to modify the interpoation scheme. To obtain a more robust interpolation scheme that is not greatly affected by a huge gap between neighboring <span class="math inline">\(x_i\)</span>, we choose K such that <span class="math display">\[
m = \lceil 10\%\text{quantile}(|x_i-x_{i+1}|) \rceil \\
K = 2^{\lceil \text{log}_2m \rceil}.
\]</span> With a robust interpolation scheme, we obtained <a href="https://kaiqianzhang.github.io/susie-np/wavelet-susie-20190228-2.html">better fits</a> for most examples, but still observed poor fits due to converging to a local optimum issue preserved in SuSiE.</p>
</div>
<div id="symlet-wavelet-based-susie" class="section level2">
<h2>5 Symlet wavelet-based SuSiE</h2>
</div>
<div id="estimate-residual-variance-mad-method" class="section level2">
<h2>6 Estimate residual variance: MAD method</h2>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li><p>Kim, S.-J., Koh, K., Boyd, S. and Gorinevsky, D. (2009). l1 trend filtering. SIAM Rev. 51 339–360.</p></li>
<li><p>Daubechies, I. (1992) Ten Lectures on Wavelets. SIAM, Philadelphia.</p></li>
<li><p>Tibshirani, R. J. (2014). Adaptive piecewise polynomial estimation via trend filtering.The Annalsof Statistics 42(1), 285–323.</p></li>
<li><p>Haris, A., Simon, N., &amp; Shojaie, A. (2018). Wavelet regression and additive models for irregularly spaced data. NeurIPS.</p></li>
<li><p>G. Mallat, St’ephane. (1989). A Theory of Multiresolution Signal Decomposition: The Wavelet Representation. IEEE Transactions on Pattern Analysis and Machine Intelligence - PAMI. 11.</p></li>
<li><p>Coifman R.R., Donoho D.L. (1995) Translation-Invariant De-Noising. In: Antoniadis A., Oppenheim G. (eds) Wavelets and Statistics. Lecture Notes in Statistics, vol 103. Springer, New York, NY.</p></li>
<li><p>Xing Z. and Stephens M. (2016). Smoothing via adaptive shrinkage (smash): denoising poisson and heteroskedastic Gaussian signals. arXiv preprint arXiv:1605.07787.</p></li>
</ul>
<br> <br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.5.3 (2019-03-11)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Sierra 10.12.6

Matrix products: default
BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
 [1] workflowr_1.2.0 Rcpp_1.0.1      digest_0.6.18   rprojroot_1.3-2
 [5] backports_1.1.4 git2r_0.25.2    magrittr_1.5    evaluate_0.13  
 [9] stringi_1.4.3   fs_1.2.7        whisker_0.3-2   rmarkdown_1.12 
[13] tools_3.5.3     stringr_1.4.0   glue_1.3.1      xfun_0.5       
[17] yaml_2.2.0      compiler_3.5.3  htmltools_0.3.6 knitr_1.22     </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
